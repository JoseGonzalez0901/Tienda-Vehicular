import{r as i,j as e}from"./index-BEvnYS48.js";import{d as M,e as S}from"./api-DUm3p9eQ.js";function f(t){return Number.isFinite(t)?"RD$ "+Math.round(t).toLocaleString("es-DO"):"RD$ 0"}function o({label:t,value:s}){return s==null||s===""||s==="N/A"?null:e.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-[--border] bg-[--surface] px-3 py-2",children:[e.jsx("span",{className:"text-[--muted] text-sm",children:t}),e.jsx("span",{className:"font-medium text-sm",children:s})]})}function C({children:t}){return e.jsx("span",{className:"px-2.5 py-1 rounded-lg text-xs bg-[--bg] border border-[--border]",children:t})}function D(t){const s=t.apr/100/12,g=t.price*(t.downPct/100),x=t.price*(t.balloonPct/100),u=Math.max(t.price-g-x,0),n=Math.max(1,t.term),p=s>0?u*(s*Math.pow(1+s,n))/(Math.pow(1+s,n)-1):u/n,b=(t.commission.type==="percent"?t.price*(t.commission.value/100):t.commission.value)/n,m=t.itbisOnCommission?b*.18:0,h=p+t.insurance+b+m,c=h*n+g+x;return{monthly:h,principal:u,effectiveMonthlyRate:s*100,totalCost:c,base:p}}function A({vehicleId:t}){const[s,g]=i.useState(null),[x,u]=i.useState([]),[n,p]=i.useState(!0),[y,b]=i.useState(null),[m,h]=i.useState("fotos"),[c,w]=i.useState(0),[a,d]=i.useState({price:0,downPct:20,term:36,apr:22,commission:{type:"percent",value:1},insurance:9e3,itbisOnCommission:!1,balloonPct:0});i.useEffect(()=>{let r=!0;return(async()=>{try{if(p(!0),b(null),!t)throw new Error("Falta el parámetro id. Ej: #/vehicle?id=veh-002");const l=await M(t);if(!r)return;g(l),d(v=>({...v,price:Number(l.price)||0})),S(t).then(v=>r&&u(v||[])).catch(()=>{}),w(0),h("fotos")}catch(l){r&&b((l==null?void 0:l.message)||"Error cargando")}finally{r&&p(!1)}})(),()=>{r=!1}},[t]);const j=i.useMemo(()=>Array.isArray(s==null?void 0:s.photos)?s.photos.slice(0,5):[],[s]),$=!!(s!=null&&s.model3dUrl),P=!!(s!=null&&s.videoUrl),N=D(a);return n?e.jsx("div",{className:"container mx-auto px-4 py-10",children:"Cargando detalle…"}):y?e.jsxs("div",{className:"container mx-auto px-4 py-10",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"No se pudo cargar"}),e.jsx("p",{className:"text-[--muted] mt-2",children:y}),e.jsx("a",{href:"#/home",className:"inline-block mt-4 px-4 py-2 rounded-xl bg-[--primary] text-[--primary-contrast]",children:"Volver al inicio"})]}):s?e.jsxs("div",{className:"container mx-auto px-4 py-8 space-y-8",children:[e.jsxs("nav",{className:"text-sm text-[--muted] flex items-center gap-2",children:[e.jsx("a",{href:"#/home",className:"hover:text-[--text]",children:"Inicio"}),e.jsx("span",{children:"›"}),e.jsx("a",{href:"#/home",className:"hover:text-[--text]",children:"Catálogo"}),e.jsx("span",{children:"›"}),e.jsxs("span",{className:"text-[--text] font-medium",children:[s.brand," ",s.model]})]}),e.jsxs("header",{children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-extrabold",children:[s.brand," ",s.model," ",s.year]}),e.jsxs("div",{className:"text-xl font-bold mt-1",children:["RD$ ",Number(s.price).toLocaleString("es-DO")]}),e.jsxs("div",{className:"mt-1 flex items-center gap-1.5 text-sm text-[--muted]",children:[e.jsx("span",{className:"material-symbols-outlined text-[--muted] text-sm",children:"location_on"}),e.jsx("span",{children:s.location||"Ubicación desconocida"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:["  ",e.jsxs("div",{className:"rounded-2xl border border-[--border] bg-[--surface]",children:[e.jsx("div",{className:"flex items-center gap-2 px-4 pt-3",children:["fotos","3d","video"].map(r=>e.jsx("button",{className:`px-3 py-1.5 rounded-lg text-sm ${m===r?"bg-[--bg] border border-[--border]":"text-[--muted]"}`,onClick:()=>h(r),children:r==="fotos"?"Fotos":r.toUpperCase()},r))}),e.jsxs("div",{className:"p-4",children:[m==="fotos"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative rounded-xl overflow-hidden border border-[--border] bg-[--bg]",children:[j[c]?e.jsx("img",{src:j[c],alt:`${s.brand} ${s.model} ${c+1}`,className:"w-full h-[260px] md:h-[360px] object-cover"}):e.jsx("div",{className:"w-full h-[260px] md:h-[360px] grid place-items-center text-[--muted]",children:"Sin fotos"}),j.length>0&&e.jsxs("div",{className:"absolute bottom-2 right-2 text-xs px-2 py-1 rounded-lg bg-[--surface]/80 border border-[--border]",children:[c+1,"/",j.length]})]}),e.jsx("div",{className:"flex gap-2 mt-3 overflow-x-auto",children:j.map((r,l)=>e.jsx("button",{onClick:()=>w(l),className:`w-20 h-14 rounded-lg overflow-hidden border ${l===c?"border-[--primary]":"border-[--border]"}`,title:`Foto ${l+1}`,children:e.jsx("img",{src:r,className:"w-full h-full object-cover"})},l))})]}),m==="3d"&&e.jsx("div",{className:"rounded-xl overflow-hidden border border-[--border] bg-[--bg] grid place-items-center h-[260px] md:h-[360px]",children:$?e.jsx("model-viewer",{src:s.model3dUrl,alt:`${s.brand} ${s.model} 3D`,"auto-rotate":!0,"camera-controls":!0,style:{width:"100%",height:"100%",background:"transparent"}}):e.jsx("div",{className:"text-[--muted]",children:"Sin modelo 3D"})}),m==="video"&&e.jsx("div",{className:"rounded-xl overflow-hidden border border-[--border] bg-[--bg]",children:P?e.jsx("video",{className:"w-full h-[260px] md:h-[360px]",src:s.videoUrl,controls:!0,playsInline:!0}):e.jsx("div",{className:"w-full h-[260px] md:h-[360px] grid place-items-center text-[--muted]",children:"Sin video"})})]})]}),e.jsxs("div",{className:"rounded-2xl border border-[--border] bg-[--surface] p-5",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Descripción del Motor"}),e.jsx("p",{className:"text-[--muted] leading-relaxed",children:s.description||"Descripción no disponible para este modelo."})]}),e.jsxs("div",{className:"rounded-2xl border border-[--border] bg-[--surface] p-5 space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Accesorios y Características"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Array.isArray(s.accessories)&&s.accessories.length>0?s.accessories.map((r,l)=>e.jsx(C,{children:r},`acc-${l}`)):e.jsx("span",{className:"text-sm text-[--muted]",children:"Sin accesorios listados."}),Array.isArray(s.features)&&s.features.map((r,l)=>e.jsx(C,{children:r},`fea-${l}`))]})]}),e.jsxs("div",{className:"rounded-2xl border border-[--border] bg-[--surface] p-5 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[e.jsx("span",{className:"material-symbols-outlined text-[--muted] text-sm",children:"shield"}),"Confianza & Garantías"]}),e.jsx("p",{className:"text-[--muted] text-sm leading-relaxed",children:"Tu tranquilidad es nuestra prioridad. Ofrecemos un servicio integral que va más allá de la venta, con garantías sólidas y el respaldo de años de experiencia en el mercado automotriz dominicano."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-xl border border-[--border] p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"material-symbols-outlined text-[--muted] text-sm",children:"verified_user"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Inspección Rigurosa"}),e.jsx("div",{className:"text-sm text-[--muted]",children:"Cada vehículo pasa por una inspección de 150 puntos para garantizar su calidad y confiabilidad."})]})]})}),e.jsx("div",{className:"rounded-xl border border-[--border] p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"material-symbols-outlined text-[--muted] text-sm",children:"acute"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Respuesta Rápida"}),e.jsx("div",{className:"text-sm text-[--muted]",children:"Respondemos todas tus consultas en menos de 2 horas durante horario laboral."})]})]})}),e.jsx("div",{className:"rounded-xl border border-[--border] p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"material-symbols-outlined text-[--muted] text-sm",children:"assignment"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Documentación Completa"}),e.jsx("div",{className:"text-sm text-[--muted]",children:"Todos los papeles en regla. Facilitamos el proceso de traspaso y financiamiento."})]})]})}),e.jsx("div",{className:"rounded-xl border border-[--border] p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"material-symbols-outlined text-[--muted] text-sm",children:"support_agent"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Soporte Post-Venta"}),e.jsx("div",{className:"text-sm text-[--muted]",children:"Acompañamiento completo después de la compra, incluyendo opciones de seguro y mantenimiento."})]})]})})]}),e.jsx("div",{className:"border-t border-[--border]/60"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-xl border border-[--border] p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:"500+"}),e.jsx("div",{className:"text-[--muted] text-sm",children:"Vehículos Vendidos"})]}),e.jsxs("div",{className:"rounded-xl border border-[--border] p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:"4.8/5"}),e.jsx("div",{className:"text-[--muted] text-sm",children:"Calificación Clientes"})]})]})]})]}),e.jsxs("aside",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-2xl border border-[--border] bg-[--surface] p-5 space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Especificaciones Técnicas"}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(o,{label:"Año",value:s.year}),e.jsx(o,{label:"Kilometraje",value:typeof s.mileageKm=="number"?`${s.mileageKm.toLocaleString()} km`:"0 km"}),e.jsx(o,{label:"Motor",value:`${s.engine||"N/A"} ${s.fuel?` ${s.fuel}`:""}`}),e.jsx(o,{label:"Combustible",value:s.fuel}),e.jsx(o,{label:"Transmisión",value:s.transmission}),e.jsx(o,{label:"Tracción",value:s.drive?`Tracción ${s.drive}`:void 0}),e.jsx(o,{label:"Potencia",value:s.powerHp?`${s.powerHp} hp`:void 0}),e.jsx(o,{label:"Torque",value:s.torqueNm?`${s.torqueNm} Nm`:void 0}),e.jsx(o,{label:"Consumo",value:s.consumption}),e.jsx(o,{label:"Puertas",value:s.doors}),e.jsx(o,{label:"Asientos",value:s.seats}),e.jsx(o,{label:"Color",value:s.color})]})]}),e.jsxs("div",{className:"rounded-2xl border border-[--border] bg-[--surface] p-5 space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Calculadora de Financiamiento"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-[--muted]",children:"Precio del Vehículo (RD$)"}),e.jsx("input",{type:"number",value:a.price,onChange:r=>d({...a,price:parseFloat(r.target.value)||0}),className:"rounded-xl border border-[--border] bg-[--bg] px-3 py-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[--muted]",children:"Inicial"}),e.jsxs("div",{className:"flex justify-between text-xs text-[--muted] mb-1",children:[e.jsxs("span",{children:["Porcentaje: ",a.downPct.toFixed(1),"%"]}),e.jsxs("span",{children:["Monto: ",f(a.price*(a.downPct/100))]})]}),e.jsx("input",{type:"range",min:0,max:80,step:.5,value:a.downPct,onChange:r=>d({...a,downPct:parseFloat(r.target.value)||0}),className:"w-full"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[--muted] mb-1",children:"Monto (RD$)"}),e.jsx("input",{type:"number",value:Math.round(a.price*(a.downPct/100)),onChange:r=>{const l=parseFloat(r.target.value)||0,v=a.price?l/a.price*100:0;d({...a,downPct:Math.max(0,Math.min(80,v))})},className:"rounded-xl border border-[--border] bg-[--bg] px-3 py-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[--muted] mb-1",children:"Porcentaje (%)"}),e.jsx("input",{type:"number",min:0,max:80,step:.5,value:Number(a.downPct.toFixed(1)),onChange:r=>d({...a,downPct:parseFloat(r.target.value)||0}),className:"rounded-xl border border-[--border] bg-[--bg] px-3 py-2 w-full"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[--muted]",children:"Plazo (meses)"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:[12,18,24,36,48,60].map(r=>e.jsxs("button",{onClick:()=>d({...a,term:r}),className:`px-3 py-1.5 rounded-lg border text-sm ${a.term===r?"bg-[--primary] text-[--primary-contrast] border-transparent":"bg-[--bg] border-[--border]"}`,children:[r," meses"]},r))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[--muted]",children:"Tasa APR Anual (%)"}),e.jsx("input",{type:"number",value:a.apr,min:0,max:60,step:.1,onChange:r=>d({...a,apr:parseFloat(r.target.value)||0}),className:"rounded-xl border border-[--border] bg-[--bg] px-3 py-2 w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-xs text-[--muted]",children:"Comisión"}),e.jsxs("label",{className:"inline-flex items-center gap-2 select-none",children:[e.jsx("span",{className:"text-xs text-[--muted]",children:"%"}),e.jsx("button",{type:"button",role:"switch","aria-checked":a.commission.type==="amount",onClick:()=>d({...a,commission:{...a.commission,type:a.commission.type==="percent"?"amount":"percent"}}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors
                        ${a.commission.type==="amount"?"bg-[--primary]":"bg-[--bg] border border-[--border]"}`,children:e.jsx("span",{className:`absolute h-5 w-5 rounded-full bg-white transition-transform
                          ${a.commission.type==="amount"?"translate-x-5":"translate-x-0.5"}`,style:{boxShadow:"0 1px 2px rgba(0,0,0,.25)"}})}),e.jsx("span",{className:"text-xs text-[--muted]",children:"RD$"})]})]}),e.jsx("input",{type:"number",value:a.commission.value,onChange:r=>d({...a,commission:{...a.commission,value:parseFloat(r.target.value)||0}}),className:"rounded-xl border border-[--border] bg-[--bg] px-3 py-2 w-full",placeholder:a.commission.type==="percent"?"1":"25000"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[--muted]",children:"Seguro Mensual (RD$)"}),e.jsx("input",{type:"number",value:a.insurance,onChange:r=>d({...a,insurance:parseFloat(r.target.value)||0}),className:"rounded-xl border border-[--border] bg-[--bg] px-3 py-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[--muted]",children:"Balloon (%)"}),e.jsx("input",{type:"number",value:a.balloonPct,min:0,max:40,step:.1,onChange:r=>d({...a,balloonPct:parseFloat(r.target.value)||0}),className:"rounded-xl border border-[--border] bg-[--bg] px-3 py-2 w-full"})]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:a.itbisOnCommission,onChange:r=>d({...a,itbisOnCommission:r.target.checked})}),"Incluir ITBIS en comisiones"]}),e.jsxs("div",{className:"rounded-xl bg-[--bg] border border-[--border] p-4 text-center",children:[e.jsx("div",{className:"text-xs text-[--muted]",children:"Cuota mensual estimada"}),e.jsx("div",{className:"text-2xl font-extrabold mt-1",children:f(N.monthly)}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-4 text-center ",children:[e.jsxs("div",{className:"rounded-lg border border-[--border] p-3 ",children:[e.jsx("div",{className:"text-xs text-[--muted]",children:"Tasa efectiva mensual"}),e.jsxs("div",{className:"font-semibold",children:[N.effectiveMonthlyRate.toFixed(2),"%"]})]}),e.jsxs("div",{className:"rounded-lg border border-[--border] p-3",children:[e.jsx("div",{className:"text-xs text-[--muted]",children:"Total financiado"}),e.jsx("div",{className:"font-semibold",children:f(N.principal)})]}),e.jsxs("div",{className:"rounded-lg border border-[--border] p-3",children:[e.jsx("div",{className:"text-xs text-[--muted]",children:"Costo total del préstamo"}),e.jsx("div",{className:"font-semibold",children:f(N.totalCost)})]})]}),e.jsxs("div",{className:"flex gap-2 justify-center mt-4",children:[e.jsx("a",{className:"px-4 py-2 rounded-xl bg-[--primary] text-[--primary-contrast]",href:"#/financing",children:"Calculadora avanzada"}),e.jsx("a",{className:"px-4 py-2 rounded-xl border border-[--border]",target:"_blank",href:"https://wa.me/18090000000",rel:"noreferrer",children:"WhatsApp"})]})]})]})]})]}),x.length>0&&e.jsxs("section",{className:"rounded-2xl border border-[--border] bg-[--surface] p-5 space-y-4",children:[e.jsx("div",{className:"font-semibold",children:"Modelos relacionados"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:x.map(r=>{var l;return e.jsxs("a",{href:`#/vehicle?id=${r.id}`,className:"rounded-2xl border border-[--border] bg-[--surface] p-3 hover:border-[--primary]",children:[e.jsx("div",{className:"aspect-video w-full rounded-xl bg-[--bg] overflow-hidden mb-2",children:(l=r.photos)!=null&&l[0]?e.jsx("img",{src:r.photos[0],alt:`${r.brand} ${r.model}`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full grid place-items-center text-[--muted]",children:"Sin foto"})}),e.jsxs("div",{className:"text-sm font-semibold",children:[r.brand," ",r.model]}),e.jsx("div",{className:"text-xs text-[--muted]",children:r.year}),e.jsxs("div",{className:"text-sm font-bold mt-1",children:["RD$ ",Number(r.price).toLocaleString("es-DO")]})]},r.id)})}),e.jsx("div",{className:"text-center pt-2",children:e.jsx("a",{href:"#/home",className:"px-4 py-2 rounded-xl border border-[--border]",children:"Ver todos los vehículos"})})]})]}):null}export{A as default};
