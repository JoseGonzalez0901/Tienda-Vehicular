const g="",c=t=>t,p=t=>{const o=new URLSearchParams;Object.entries(t).forEach(([s,e])=>{e!=null&&e!==""&&o.append(s,String(e))});const i=o.toString();return i?`?${i}`:""},d=t=>t?/^https?:\/\//i.test(t)?t:`${g}${t}`:"",f=t=>{const o=(t??"").trim().split(/\s+/),i=o[0]??"",s=o.slice(1).join(" ");return{brand:i,model:s}},u=t=>t==="Nuevo"||t==="Usado"?t:void 0,h=(t,o)=>{const{brand:i,model:s}=f(t.title),e=d(t.coverUrl);return{id:String(t.id),brand:i,model:s,year:t.year,price:t.price,type:o.type,condition:u(t.condition)??o.condition??"Usado",location:t.location??void 0,mileageKm:t.mileageKm??void 0,photos:e?[e]:[]}},m=(t,o)=>{let i=t.brand,s=t.model;if(!i||!s){const r=f(t.title??"");i??(i=r.brand),s??(s=r.model)}const e=(t.gallery??[]).map(d).filter(Boolean),n=t.specs??{};return{id:String(t.id),brand:i??"",model:s??"",year:t.year??0,price:t.price,type:t.type??o.type,condition:u(t.condition)??o.condition??"Usado",photos:e,fuel:t.fuel,transmission:t.transmission,color:t.color??void 0,mileageKm:n.mileageKm,powerHp:n.powerHp,torqueNm:n.torqueNm,doors:n.doors,seats:n.seats,engine:n.engine,drive:n.drive,consumption:n.consumption,location:t.location??void 0,accessories:n.accessories,features:n.features,description:n.description,model3dUrl:t.model3DUrl?d(t.model3DUrl):void 0,videoUrl:t.videoUrl?d(t.videoUrl):void 0}};async function w(){const t=await fetch(c("/api/filters"));if(!t.ok)throw new Error("filters "+t.status);return t.json()}async function b(t={}){const{tab:o,limit:i=10,page:s=1,filters:e={},defaultType:n="carro",defaultCondition:r}=t,a=await fetch(c(`/api/vehicles${p({tab:o,limit:i,page:s,...e})}`));if(!a.ok)throw new Error("vehicles "+a.status);const l=await a.json();return{total:l.total,page:l.page,pageSize:l.pageSize,items:l.items.map(y=>h(y,{type:e.type??n,condition:r}))}}async function U(t,o={}){const{defaultType:i="carro",defaultCondition:s}=o,e=await fetch(c(`/api/vehicles/${t}`));if(!e.ok)throw new Error("vehicle "+e.status);const n=await e.json();return m(n,{type:i,condition:s})}async function S(t,o={}){const{defaultType:i="carro",defaultCondition:s,listShape:e}=o,n=await fetch(c(`/api/vehicles/${t}/related`));if(!n.ok)throw new Error("related "+n.status);const r=await n.json();return Array.isArray(r)?e||r.length&&"year"in r[0]?r.map(a=>h(a,{type:i,condition:s})):r.map(a=>m(a,{type:i,condition:s})):[]}async function j(t={}){const{page:o=1,q:i,category:s}=t,e=await fetch(c(`/api/blogs${p({page:o,q:i,category:s})}`));if(!e.ok)throw new Error("blogs "+e.status);return e.json()}async function E(t){const o=await fetch(c(`/api/blogs/${t}`));if(!o.ok)throw new Error("blog "+o.status);return o.json()}export{b as a,j as b,E as c,U as d,S as e,w as f};
